#include <stdio.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <unistd.h>
#include <fcntl.h>
#include <string.h>

#define FIFO_PATH "./text"

void countWordsLinesChars(char *sentence, int *wordCount, int *lineCount, int *charCount) {
    char *token;
    *wordCount = 0;
    *lineCount = 1;  // Default 1 line
    *charCount = strlen(sentence);

    token = strtok(sentence, " \n");
    while (token != NULL) {
        (*wordCount)++;
        token = strtok(NULL, " \n");
    }
}

int main() {
    int fd;
    char buffer[100];
    ssize_t bytesRead;

    // Create FIFO if not exists
    mkfifo(FIFO_PATH, 0666);

    // Open FIFO for reading
    fd = open(FIFO_PATH, O_RDONLY);
    if (fd == -1) {
        perror("Error opening FIFO for reading");
        return 1;
    }

    while (1) {
        bytesRead = read(fd, buffer, sizeof(buffer) - 1);
        if (bytesRead <= 0)
            break;

        buffer[bytesRead] = '\0';

        if (strcmp(buffer, "exit\n") == 0) {
            printf("Exiting reader...\n");
            break;
        }

        printf("Received: %s", buffer);

        char temp[100];
        strncpy(temp, buffer, sizeof(temp));
        temp[sizeof(temp) - 1] = '\0';

        int wordCount, lineCount, charCount;
        countWordsLinesChars(temp, &wordCount, &lineCount, &charCount);

        printf("Characters: %d\n", charCount);
        printf("Words: %d\n", wordCount);
        printf("Lines: %d\n", lineCount);
    }

    close(fd);
    return 0;
}
//2 code

#include <stdio.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <fcntl.h>
#include <unistd.h>
#include <string.h>
#include <errno.h>

#define FIFO_PATH "./text"

int main() {
    int fd;
    char buffer[100];

    // Create FIFO if not exists
    if (mkfifo(FIFO_PATH, 0666) == -1 && errno != EEXIST) {
        perror("Error creating FIFO");
        return 1;
    }

    // Open FIFO for writing
    fd = open(FIFO_PATH, O_WRONLY);
    if (fd == -1) {
        perror("Error opening FIFO for writing");
        return 1;
    }

    while (1) {
        printf("Enter a sentence (or 'exit' to quit): ");
        if (fgets(buffer, sizeof(buffer), stdin) == NULL) {
            perror("Error reading input");
            break;
        }

        // Write to FIFO
        if (write(fd, buffer, strlen(buffer) + 1) == -1) {
            perror("Error writing to FIFO");
            break;
        }

        // Exit condition
        if (strcmp(buffer, "exit\n") == 0)
            break;
    }

    close(fd);
    return 0;
}

   
